var $jscomp={scope:{},checkStringArgs:function(d,c,a){if(null==d)throw new TypeError("The 'this' value for String.prototype."+a+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+a+" must not be a regular expression");return d+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,c,a){if(a.get||a.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[c]=a.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(d,c,a,m){if(c){a=$jscomp.global;d=d.split(".");for(m=0;m<d.length-1;m++){var h=d[m];h in a||(a[h]={});a=a[h]}d=d[d.length-1];m=a[d];c=c(m);c!=m&&null!=c&&$jscomp.defineProperty(a,d,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("String.prototype.includes",function(d){return d?d:function(c,a){return-1!==$jscomp.checkStringArgs(this,c,"includes").indexOf(c,a||0)}},"es6-impl","es3");
(function(d){if("undefined"!==typeof this.S2D)return console.warn("Simple 2D already loaded! Loading twice may cause problems."),this.S2D;var c=this.S2D={};c.GL={};Object.defineProperty(c,"KEYDOWN",{value:1});Object.defineProperty(c,"KEY",{value:2});Object.defineProperty(c,"KEYUP",{value:3});Object.defineProperty(c,"FIXED",{value:1});Object.defineProperty(c,"SCALE",{value:2});Object.defineProperty(c,"STRETCH",{value:3});c.Color={r:1,g:1,b:1,a:1};c.Window={title:null,width:null,height:null,orig_width:null,
orig_height:null,viewport:{width:null,height:null,mode:null},pixel_ratio:null,update:null,render:null,mouse:{x:0,y:0},on_key:null,on_mouse:null,element:null,canvas:null,background:null,frames:0,close:!1};c.Image={texture:null,data:null,color:null,x:0,y:0,width:null,height:null,orig_width:null,orig_height:null};c.Sprite={img:null,x:0,y:0,width:null,height:null,tx1:null,ty1:null,tx2:null,ty2:null,tx3:null,ty3:null,tx4:null,ty4:null};c.Text={texture:null,data:null,color:null,x:0,y:0,width:null,height:null,
font:null,size:null,msg:null};c.Sound={data:null};c.Music={data:null};c.current_music=null;c.keys_down=[];c.key_map={27:"Escape",192:"`",189:"-",187:"=",8:"Backspace",9:"Tab",219:"[",221:"]",220:"\\",20:"CapsLock",186:";",222:"'",13:"Return",16:"Shift",188:",",190:".",191:"/",17:"Ctrl",18:"Option",91:"Left Command",32:"Space",93:"Right Command",37:"Left",38:"Up",39:"Right",40:"Down"};c.GetKey=function(b){return"string"==typeof b?b:c.key_map[b]?c.key_map[b]:String.fromCharCode(b)};c.TrimCanvas=function(b){var c=
b.getContext("2d"),a=document.createElement("canvas").getContext("2d"),k=c.getImageData(0,0,b.width,b.height),e=k.data.length,l,f=null,r=null,d=null,h=null,p,q;for(l=0;l<e;l+=4)0!==k.data[l+3]&&(p=l/4%b.width,q=~~(l/4/b.width),null===f&&(f=q),null===r?r=p:p<r&&(r=p),null===d?d=p:d<p&&(d=p),null===h?h=q:h<q&&(h=q));b=h-f;d-=r;c=c.getImageData(r,f,d,b);a.canvas.width=d;a.canvas.height=b;a.putImageData(c,0,0);return a.canvas};c.DrawTriangle=function(b,a,A,k,e,l,f,r,d,h,p,q,n,m,u,v,w,C){c.GL.DrawTriangle(b,
a,A,k,e,l,f,r,d,h,p,q,n,m,u,v,w,C)};c.DrawQuad=function(b,a,A,k,e,d,f,r,h,n,p,q,m,B,u,v,w,C,t,x,y,z,D,E){c.GL.DrawTriangle(b,a,A,k,e,d,f,r,h,n,p,q,m,B,u,v,w,C);c.GL.DrawTriangle(m,B,u,v,w,C,t,x,y,z,D,E,b,a,A,k,e,d)};c.CreateImage=function(b,a){var g=Object.create(c.Image);g.data=new Image;g.color=Object.create(c.Color);g.data.onload=function(){g.texture=c.GL.CreateTexture(this);g.width||(g.width=this.width);g.height||(g.height=this.height);a&&a()};g.data.src=b;return g};c.DrawImage=function(b){b&&
c.GL.DrawImage(b)};c.CreateSprite=function(b){var a=Object.create(c.Sprite);a.img=c.CreateImage(b,function(){a.width=a.img.width;a.height=a.img.height});a.tx1=0;a.ty1=0;a.tx2=1;a.ty2=0;a.tx3=1;a.ty3=1;a.tx4=0;a.ty4=1;return a};c.ClipSprite=function(b,a,c,k,e){if(b){var g=k/b.img.width,f=e/b.img.height;a*=g;c*=f;g*=k;f*=e;b.tx1=a/k;b.ty1=c/e;b.tx2=(a+g)/k;b.ty2=c/e;b.tx3=(a+g)/k;b.ty3=(c+f)/e;b.tx4=a/k;b.ty4=(c+f)/e;b.width=k;b.height=e}};c.DrawSprite=function(b){b&&c.GL.DrawSprite(b)};c.CreateText=
function(b,a,A){var g=Object.create(c.Text);g.color=Object.create(c.Color);g.font=b;g.msg=a;g.size=A;return g};c.SetText=function(b,a){if(""!=a){c.GL.FreeTexture(b.texture);var g=document.createElement("canvas").getContext("2d"),d=2*b.size;g.canvas.width=1E3;g.canvas.height=1E3;g.font=d+"px "+b.font;g.textAlign="right";g.textBaseline="bottom";g.fillStyle="white";g.fillText(a,1E3,1E3);b.data=c.TrimCanvas(g.canvas);b.texture=c.GL.CreateTexture(b.data);b.width=b.data.width/2;b.height=b.data.height/2}};
c.DrawText=function(b){b&&(b.texture||c.SetText(b,b.msg),c.GL.DrawText(b))};c.CreateSound=function(b){var a=Object.create(c.Sound);a.data=new Audio(b);return a};c.PlaySound=function(b){b.data.cloneNode(!0).play()};c.CreateMusic=function(b){var a=Object.create(c.Music);a.data=new Audio(b);return a};c.PlayMusic=function(b,a){c.StopMusic();b.data.loop=a;c.current_music=b.data;c.current_music.play()};c.PauseMusic=function(){c.current_music&&c.current_music.pause()};c.ResumeMusic=function(){c.current_music&&
c.current_music.play()};c.StopMusic=function(){c.current_music&&(c.current_music.pause(),c.current_music.currentTime=0)};c.FadeOutMusic=function(b){if(c.current_music)if(c.current_music.paused)c.StopMusic();else var a=setInterval(function(){.05<=c.current_music.volume?c.current_music.volume-=.05:(c.StopMusic(),c.current_music.volume=1,clearInterval(a))},b/20)};c.GetMouseOnViewport=function(b,a,d){var g,e;switch(b.viewport.mode){case c.FIXED:g=a/(b.orig_width/b.viewport.width);e=d/(b.orig_height/b.viewport.height);
break;case c.SCALE:e=c.GL.GetViewportScale(b);g=1*a/e.scale-(b.width-e.w)/(2*e.scale);e=1*d/e.scale-(b.height-e.h)/(2*e.scale);break;case c.STRETCH:g=a*b.viewport.width/b.width,e=d*b.viewport.height/b.height}return{x:g,y:e}};c.CreateWindow=function(b,a,d,k,e,l,f){f=Object.create(c.Window);f.title=b;f.width=a;f.height=d;f.orig_width=a;f.orig_height=d;f.viewport.width=a;f.viewport.height=d;f.viewport.mode=c.SCALE;f.update=k;f.render=e;f.background=Object.create(c.Color);f.background.r=0;f.background.g=
0;f.background.b=0;f.background.a=1;f.element="string"==typeof l?document.getElementById(l):l;return f};c.Show=function(b){function a(b){b.close?cancelAnimationFrame(k):(c.GL.Clear(b.background),b.frames++,l=new Date,f=l.getTime()-e.getTime(),b.fps=b.frames/(f/1E3),c.keys_down.forEach(function(a){if(b.on_key)b.on_key(c.KEY,a)}),b.update&&b.update(),b.render&&b.render(),requestAnimationFrame(function(){a(b)}))}var d=document.createElement("canvas");b.element.appendChild(d);d.setAttribute("width",b.width);
d.setAttribute("height",b.height);d.innerHTML="Your browser doesn't appear to supportthe <code>&lt;canvas&gt;</code> element.";b.canvas=d;b.canvas.style.width=b.width+"px";b.canvas.style.height=b.height+"px";d=window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||window.opDevicePixelRatio||1;b.canvas.width=b.width*devicePixelRatio;b.canvas.height=b.height*devicePixelRatio;b.pixel_ratio=d;c.GL.Init(b);c.onkeydown=function(a){a=c.GetKey(a.keyCode);if(!c.keys_down.includes(a)&&
(c.keys_down.push(a),b.on_key))b.on_key(c.KEYDOWN,a)};document.addEventListener("keydown",c.onkeydown);c.onkeyup=function(a){a=c.GetKey(a.keyCode);var g=c.keys_down.indexOf(a);-1<g&&c.keys_down.splice(g,1);if(b.on_key)b.on_key(c.KEYUP,a)};document.addEventListener("keyup",c.onkeyup);window.addEventListener("blur",function(){var b={};c.keys_down.slice().forEach(function(a){b.keyCode=a;c.onkeyup(b)})});c.onmousedown=function(a){a=c.GetMouseOnViewport(b,a.pageX-b.canvas.offsetLeft,a.pageY-b.canvas.offsetTop);
if(b.on_mouse)b.on_mouse(a.x,a.y)};document.addEventListener("mousedown",c.onmousedown);c.onmousemove=function(a){a=c.GetMouseOnViewport(b,a.pageX-b.canvas.offsetLeft,a.pageY-b.canvas.offsetTop);b.mouse.x=a.x;b.mouse.y=a.y};document.addEventListener("mousemove",c.onmousemove);var k,e=new Date,l=new Date,f;k=requestAnimationFrame(function(){a(b)})};c.Close=function(a){a.close=!0};var a=null,m=[0,1,2,2,3,0],h,x,y,n,z,D,E,F,t=[0,0,0,0,0,0,0,0,0,0,0,0,-1,1,-1,1];c.GL.Init=function(b){try{a=b.canvas.getContext("webgl")||
b.canvas.getContext("experimental-webgl")}catch(g){console.log("GL error caught")}if(!a)return console.error("Unable to initialize WebGL. Your browser may not support it."),null;c.GL.WebGLInit();c.GL.SetViewport(b)};c.GL.WebGLInit=function(){a.enable(a.BLEND);a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);var b=c.GL.LoadShader(a.VERTEX_SHADER,"\n    uniform mat4 u_matrix;\n    attribute vec4 a_position;\n    attribute vec4 a_color;\n    attribute vec2 a_texcoord;\n    varying vec4 v_color;\n    varying vec2 v_texcoord;\n    void main(void) {\n      v_color = a_color;\n      v_texcoord = a_texcoord;\n      gl_Position = u_matrix * a_position;\n    }",
"Vertex"),g=c.GL.LoadShader(a.FRAGMENT_SHADER,"\n    precision mediump float;\n    varying vec4 v_color;\n    void main(void) {\n      gl_FragColor = v_color;\n    }","Fragment"),d=c.GL.LoadShader(a.FRAGMENT_SHADER,"\n    precision mediump float;\n    varying vec4 v_color;\n    varying vec2 v_texcoord;\n    uniform sampler2D s_texture;\n    void main(void) {\n      gl_FragColor = texture2D(s_texture, v_texcoord) * v_color;\n    }","Texture Fragment");h=a.createProgram();a.attachShader(h,b);a.attachShader(h,
g);a.linkProgram(h);a.getProgramParameter(h,a.LINK_STATUS)||console.error("Unable to initialize the shader program.");x=a.getAttribLocation(h,"a_position");y=a.getAttribLocation(h,"a_color");n=a.createProgram();a.attachShader(n,b);a.attachShader(n,d);a.linkProgram(n);a.getProgramParameter(n,a.LINK_STATUS)||console.error("Unable to initialize the texture shader program.");z=a.getAttribLocation(n,"a_position");D=a.getAttribLocation(n,"a_color");E=a.getAttribLocation(n,"a_texcoord");F=a.getUniformLocation(n,
"s_texture")};c.GL.LoadShader=function(b,c,d){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return a.getShaderParameter(b,a.COMPILE_STATUS)?b:(console.error('Error compiling shader "'+d+'":\n'+a.getShaderInfoLog(b)),null)};c.GL.GetViewportScale=function(a){var b=Math.min(a.width/a.viewport.width,a.height/a.viewport.height);return{w:a.viewport.width*b,h:a.viewport.height*b,scale:b}};c.GL.SetViewport=function(b){var d=b.viewport.width,m=b.viewport.height,k,e,l,f;e=k=0;l=b.width;f=b.height;
switch(b.viewport.mode){case c.FIXED:l=b.orig_width;f=b.orig_height;e=b.height-f;break;case c.SCALE:e=c.GL.GetViewportScale(b),k=b.width/2-e.w/2,e=b.height/2-e.h/2}a.viewport(k*b.pixel_ratio,e*b.pixel_ratio,l*b.pixel_ratio,f*b.pixel_ratio);t[0]=2/d;t[5]=-2/m;a.useProgram(h);a.uniformMatrix4fv(a.getUniformLocation(h,"u_matrix"),!1,new Float32Array(t));a.useProgram(n);a.uniformMatrix4fv(a.getUniformLocation(n,"u_matrix"),!1,new Float32Array(t))};c.GL.Clear=function(b){a.clearColor(b.r,b.g,b.b,b.a);
a.clear(a.COLOR_BUFFER_BIT)};c.GL.CreateTexture=function(b){var c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null);return c};c.GL.FreeTexture=function(b){a.deleteTexture(b)};
c.GL.DrawTriangle=function(b,c,d,k,e,l,f,m,n,t,p,q,z,B,u,v,w,C){b=[b,c,0,f,m,0,z,B,0];d=[d,k,e,l,n,t,p,q,u,v,w,C];a.useProgram(h);a.bindBuffer(a.ARRAY_BUFFER,a.createBuffer());a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);a.vertexAttribPointer(x,3,a.FLOAT,!1,0,0);a.enableVertexAttribArray(x);a.bindBuffer(a.ARRAY_BUFFER,a.createBuffer());a.bufferData(a.ARRAY_BUFFER,new Float32Array(d),a.STATIC_DRAW);a.vertexAttribPointer(y,4,a.FLOAT,!1,0,0);a.enableVertexAttribArray(y);a.drawArrays(a.TRIANGLES,
0,3)};c.GL.DrawTexture=function(b,c,d,k,e,l,f,h,t,x,p,q,y,B,u,v,w){b=[b,c,0,t,x,b+d,c,0,p,q,b+d,c+k,0,y,B,b,c+k,0,u,v];e=[e,l,f,h,e,l,f,h,e,l,f,h,e,l,f,h];a.useProgram(n);a.bindBuffer(a.ARRAY_BUFFER,a.createBuffer());a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);a.vertexAttribPointer(z,3,a.FLOAT,!1,20,0);a.enableVertexAttribArray(z);a.vertexAttribPointer(E,2,a.FLOAT,!1,20,12);a.enableVertexAttribArray(E);a.bindBuffer(a.ARRAY_BUFFER,a.createBuffer());a.bufferData(a.ARRAY_BUFFER,new Float32Array(e),
a.STATIC_DRAW);a.vertexAttribPointer(D,4,a.FLOAT,!1,0,0);a.enableVertexAttribArray(D);a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,w);a.uniform1i(F,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,a.createBuffer());a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(m),a.STATIC_DRAW);a.drawElements(a.TRIANGLES,m.length,a.UNSIGNED_SHORT,0)};c.GL.DrawImage=function(a){c.GL.DrawTexture(a.x,a.y,a.width,a.height,a.color.r,a.color.g,a.color.b,a.color.a,0,0,1,0,1,1,0,1,a.texture)};c.GL.DrawSprite=function(a){c.GL.DrawTexture(a.x,
a.y,a.width,a.height,a.img.color.r,a.img.color.g,a.img.color.b,a.img.color.a,a.tx1,a.ty1,a.tx2,a.ty2,a.tx3,a.ty3,a.tx4,a.ty4,a.img.texture)};c.GL.DrawText=function(a){c.GL.DrawTexture(a.x,a.y,a.width,a.height,a.color.r,a.color.g,a.color.b,a.color.a,0,0,1,0,1,1,0,1,a.texture)}}).call(this);
